/*
* Fancy Product Designer - jQuery plugin 2.1.32 
* Copyright 2013, Rafael Dery
*
* Only for the sale at the envato marketplaces
*/
!function(a){var b=function(b,c){var d=a.extend({},a.fn.fancyProductDesigner.defaults,c);d.elementParameters=a.extend({},a.fn.fancyProductDesigner.defaults.elementParameters,d.elementParameters),d.textParameters=a.extend({},a.fn.fancyProductDesigner.defaults.textParameters,d.textParameters),d.customTextParameters=a.extend({},a.fn.fancyProductDesigner.defaults.customTextParameters,d.customTextParameters),d.customImagesParameters=a.extend({},a.fn.fancyProductDesigner.defaults.customImagesParameters,d.customImagesParameters),d.dimensions=a.extend({},a.fn.fancyProductDesigner.defaults.dimensions,d.dimensions),d.labels=a.extend({},a.fn.fancyProductDesigner.defaults.labels,d.labels),d.labels.colorpicker=a.extend({},a.fn.fancyProductDesigner.defaults.labels.colorpicker,d.labels.colorpicker),d.sidebarLabels=a.extend({},a.fn.fancyProductDesigner.defaults.sidebarLabels,d.sidebarLabels),d.productStageLabels=a.extend({},a.fn.fancyProductDesigner.defaults.productStageLabels,d.productStageLabels);var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z=this,A=null,B=null,C=0,D=-1,E=null,F=0,G=null,H=null,I=0,J=1,K=1,L={},M=new Image,N=new Image,O=new Image;M.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6QkNGMzVGRDE0NENBMTFFMzlDNTlBQzY1MzlBMkNBNzMiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6QkNGMzVGRDI0NENBMTFFMzlDNTlBQzY1MzlBMkNBNzMiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpCQ0YzNUZDRjQ0Q0ExMUUzOUM1OUFDNjUzOUEyQ0E3MyIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpCQ0YzNUZEMDQ0Q0ExMUUzOUM1OUFDNjUzOUEyQ0E3MyIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Pj80kqoAAAHdSURBVHjalFO7agJREB2Xa6Hio1CIEbSIKIidptJOENJYCraBlGnyCX5BiF8gCUEhWClYhQULIaRUFlQEX4VKCp/gczJ3yW5iYsLmwHL3vs7MnDmX1Wo1IJyYTKYrvV5/hgT4AzqdTtjtdm+LxeJxv9+/AhE4x+PxC03wP5jP52NJkqLMaDRe2u328++RVqsV9Ho9oGhgsVjA6XQe7FPGdqvVegPdbjfzlXk6nWI6nUa/349UEgqCgDabDePxOJbLZflMoVDAVquFk8lEhE6nc6tcpn8MhUJcg1+/ZDKJZrMZ6/U6L+NZJaCUMRKJqAcZYxiLxTCVSqHP5/tB1Gw2cTabfRJks1l10+12Y6VSUcvabreYSCQOCBqNhkzAqC2yKLlcTmkTZDIZiEajqmClUgmq1SqQHvJcGTkYn1ALod1uywsulwtIsAPFA4EAiKKoXuRBPB4PkODAjhgFlKwUeL3eo6binhN4dM5MdcuLg8EAqF2gFYLiXGqPPHLCfD6vmYB34Y4rvVwuMRgMYjgcxuFwqMnOo9FIZDTOOJHBYIBisQhkbXA4HJqC87gCvaoH6ueQL3BltV7ebDZAVr7nGUj9fv+CHsY1ue/0wyh/vmjSaU5Bc+v1+uldgAEAQbiBjYjV1d0AAAAASUVORK5CYII=",N.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6RkY3RjhCMTI0NENEMTFFMzlDNTlBQzY1MzlBMkNBNzMiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6RkY3RjhCMTM0NENEMTFFMzlDNTlBQzY1MzlBMkNBNzMiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpCQ0YzNUZENzQ0Q0ExMUUzOUM1OUFDNjUzOUEyQ0E3MyIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpCQ0YzNUZEODQ0Q0ExMUUzOUM1OUFDNjUzOUEyQ0E3MyIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Pj7soO0AAAG9SURBVHjalFM9awJBEJ07TwstlPMKL4WFVlEsU5lGEMHKQizSSSBlmoA/wH+QP2AlhBSptLESBCtJIyqCH6BgETwFNeeBH+dmdskdhiR3yYMtdnf2zbw3s1y32wVEwOPx3DmdzjBBgAU4juN1XV9ut9un0+n0CkggK4rSIv8APiSqqir9fv9acLvdt5IkXU0mE2g0GsDzPOz3e/D5fJDJZEAQhJ+qAKxYwpgHvBcC9LDZbEI+n2cBsixDuVwGh8NhpYaSizxWpNONy+UyL7AiiEajLJMVqBre2GiaBsFgENLpNHQ6HYjH49But8EOJoEoilAqlaBarUIymYTpdArL5dKWgAY+Gs4aWCwWpNWyb8x8Pq8L584a8Pv9bJ0DE7AO/SrBCrVaDRKJBIxGI7Yfj8es1SypIcFqaHK5HJ1OEolESKVSIalUiux2O4Ie1W0JKFarFclms4yErnCYTTwj4P8iw+v1QqFQMAcL/4JpgYBE73YEw+EQisUixGIxOjwQCoUMYzXo9XqXm83mzUrC4XAgx+PxyxmaSAaDwQ2toD+bzdJY5j3O9sWnzm+f56zNHGZW1+v1M5K8fAgwAKZZlVqllD6aAAAAAElFTkSuQmCC",O.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDowMTgwMTE3NDA3MjA2ODExOEE2RDlFMzNBNzM3REJDNyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpFQTNDNjY0RUUwRTcxMUUzQjIzMjgwOEVFRDlEQzYzRCIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpFQTNDNjY0REUwRTcxMUUzQjIzMjgwOEVFRDlEQzYzRCIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjAyODAxMTc0MDcyMDY4MTE4QTZEOUUzM0E3MzdEQkM3IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjAxODAxMTc0MDcyMDY4MTE4QTZEOUUzM0E3MzdEQkM3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+LSpQ5wAAAbtJREFUeNqUUztrAkEQnju1slBSiKaxOCwOEUkfRP+A4KM5G21S5hekNajYpLO2CSlCythZWYVgpQgioiIYPdP4fm9mj9zixjMkHxzHzM58O/PNjlCr1QDhtFqtNxaLRSII+AWCIIj7/f5zPp8/Hg6Hd0ACl6qqb2iQv4LGzmYztdFoXEO73b47PhyPx2cTt9stWSwWzB4MBi+i2Wx26uWVy2Xw+/2QTqdPSl+v1xCJRCAQCECv19N8mHsB3W73QWcMhUK0f+3L5XLsptVqReLxODvLZDKafzQalTmCVqtFvF4vC8zn82Q6nZJoNMp8iURC8xkSUHQ6HY7E4/FwyVQHHYYEFP1+n6AWLJF+yWSS4Pi4OEogGs3a5XKBw+HgfJIkgSgahP+sYLlcknA4zG5GpU/EO9sCPg4uOZVKkWq1ymmSzWbPE8RiMU6w3W7HhJVlmZ0VCgVOA9ZYMBjU/oqiQLFYBJPJpNlutxtKpRLgRMBut4PP59NTRED2++O+KpWK9nCMQCvB3WH2cDh8hXq9Lk8mkw/yT2w2G9JsNhWBrjOO58pms92i4pffff660biNM3yNT0jy/CXAACPMXDtDjD7PAAAAAElFTkSuQmCC",g=a(b).addClass("fpd-container fpd-clearfix fpd-"+d.layout).before('<p class="fpd-initiliazing">'+d.labels.initText+'<br /><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAzMiAzMiIgd2lkdGg9IjMyIiBoZWlnaHQ9IjMyIiBmaWxsPSJibGFjayI+CiAgPGNpcmNsZSB0cmFuc2Zvcm09InRyYW5zbGF0ZSg4IDApIiBjeD0iMCIgY3k9IjE2IiByPSIwIj4KICAgIDxhbmltYXRlIGF0dHJpYnV0ZU5hbWU9InIiIHZhbHVlcz0iMDsgNDsgMDsgMCIgZHVyPSIxLjJzIiByZXBlYXRDb3VudD0iaW5kZWZpbml0ZSIgYmVnaW49IjAiCiAgICAgIGtleXRpbWVzPSIwOzAuMjswLjc7MSIga2V5U3BsaW5lcz0iMC4yIDAuMiAwLjQgMC44OzAuMiAwLjYgMC40IDAuODswLjIgMC42IDAuNCAwLjgiIGNhbGNNb2RlPSJzcGxpbmUiIC8+CiAgPC9jaXJjbGU+CiAgPGNpcmNsZSB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxNiAwKSIgY3g9IjAiIGN5PSIxNiIgcj0iMCI+CiAgICA8YW5pbWF0ZSBhdHRyaWJ1dGVOYW1lPSJyIiB2YWx1ZXM9IjA7IDQ7IDA7IDAiIGR1cj0iMS4ycyIgcmVwZWF0Q291bnQ9ImluZGVmaW5pdGUiIGJlZ2luPSIwLjMiCiAgICAgIGtleXRpbWVzPSIwOzAuMjswLjc7MSIga2V5U3BsaW5lcz0iMC4yIDAuMiAwLjQgMC44OzAuMiAwLjYgMC40IDAuODswLjIgMC42IDAuNCAwLjgiIGNhbGNNb2RlPSJzcGxpbmUiIC8+CiAgPC9jaXJjbGU+CiAgPGNpcmNsZSB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyNCAwKSIgY3g9IjAiIGN5PSIxNiIgcj0iMCI+CiAgICA8YW5pbWF0ZSBhdHRyaWJ1dGVOYW1lPSJyIiB2YWx1ZXM9IjA7IDQ7IDA7IDAiIGR1cj0iMS4ycyIgcmVwZWF0Q291bnQ9ImluZGVmaW5pdGUiIGJlZ2luPSIwLjYiCiAgICAgIGtleXRpbWVzPSIwOzAuMjswLjc7MSIga2V5U3BsaW5lcz0iMC4yIDAuMiAwLjQgMC44OzAuMiAwLjYgMC40IDAuODswLjIgMC42IDAuNCAwLjgiIGNhbGNNb2RlPSJzcGxpbmUiIC8+CiAgPC9jaXJjbGU+Cjwvc3ZnPg==" /></p>'),f=g.prev(".fpd-initiliazing"),u=g.children(".fpd-product").remove(),v=g.children(".fpd-design"),("icon-sb-top"==d.layout||"icon-sb-bottom"==d.layout)&&g.addClass("fpd-horizontal");var P=document.createElement("canvas"),Q=Boolean(P.getContext&&P.getContext("2d"));if(!Q)return a.post(d.templatesDirectory+"canvaserror.php",function(b){g.append(a.parseHTML(b)),g.trigger("templateLoad",[this.url])}),f.remove(),g.trigger("canvasFail").fadeIn(500),!1;window.localStorage.length,fabric.Canvas.prototype.cursorMap=["default","default","default","default","default","default","default","default"];for(var R,S=Object.keys(d.hexNames),T=S.length,U={};T--;)R=S[T],U[R.toLowerCase()]=d.hexNames[R];d.hexNames=U;var V,W="";"semantic"==d.layout&&(W="-semantic"),a.post(d.templatesDirectory+"sidebar"+W+".php",d.sidebarLabels,function(b){V=b,g.trigger("templateLoad",[this.url]),a.post(d.templatesDirectory+"productstage"+W+".php",d.productStageLabels,function(b){"icon-sb-left"==d.layout||"icon-sb-top"==d.layout||"semantic"==d.layout?g.append(a.parseHTML(V)).append(a.parseHTML(b)):g.append(a.parseHTML(b)).append(a.parseHTML(V)),h=g.children(".fpd-sidebar"),i=h.children(".fpd-navigation"),j=h.children(".fpd-content"),n=j.find(".fpd-toolbar"),o=n.find(".fpd-helper-buttons-wrapper"),p=n.find(".fpd-color-picker"),r=n.find(".fpd-patterns-wrapper"),s=n.find(".fpd-curved-text-wrapper"),"semantic"!=d.layout?g.hasClass("fpd-horizontal")?(h.css("width",d.dimensions.sidebarSize),i.find(".fpd-nav-item").css("line-height",d.dimensions.sidebarNavSize+"px"),i.css("height",d.dimensions.sidebarNavSize)):(h.css("height",d.dimensions.sidebarSize),i.css("width",d.dimensions.sidebarNavSize),j.css("width",d.dimensions.sidebarContentWidth)):h.css("width",d.dimensions.sidebarSize),k=g.children(".fpd-product-container").width(d.dimensions.productStageWidth),l=k.children(".fpd-product-stage").height(d.dimensions.productStageHeight),t=l.children(".fpd-element-tooltip").html(d.labels.outOfContainmentAlert),m=k.children(".fpd-menu-bar").addClass("fpd-"+d.menubarPosition),y=k.append('<div class="fpd-product-loader"><div class="fpd-loading"></div></div>').children(".fpd-product-loader").hide(),g.trigger("templateLoad",[this.url]),setTimeout(X,1e3)})});var X=function(){var b=l.children("canvas").get(0);if(e=new fabric.Canvas(b,{selection:!1,hoverCursor:"pointer",rotationCursor:"default",controlsAboveOverlay:!0,centeredScaling:!0}),e.setDimensions({width:k.width(),height:d.dimensions.productStageHeight}),1!==window.devicePixelRatio){var c=e.getElement();c.setAttribute("width",k.width()*window.devicePixelRatio),c.setAttribute("height",d.dimensions.productStageHeight*window.devicePixelRatio),c.getContext("2d").scale(window.devicePixelRatio,window.devicePixelRatio)}d.tooltips&&a(".fpd-tooltip").tooltipster({offsetY:-3,theme:".fpd-tooltip-theme",touchDevices:!1}),e.on({"mouse:down":function(a){if(void 0==a.target)z.deselectElement();else{var b=e.getPointer(a.e),c=a.target.findTargetCorner(b);"tr"==c&&H.params.removable&&z.removeElement(H)}},"text:changed":function(a){ub(a.target,a.target.text)},"object:moving":function(a){(H&&H.params.draggable||d.editorMode)&&(H.params.x=Math.round(a.target.left/J),H.params.y=Math.round(a.target.top/J),_(H),hb(H))},"object:scaling":function(a){(H&&H.params.resizable||d.editorMode)&&(H.params.scale=Number(a.target.scaleX/J).toFixed(2),a.target.setCoords(),_(H),hb(H))},"object:rotating":function(a){(H&&H.params.rotatable||d.editorMode)&&(H.params.degree=Math.round(a.target.angle/J),_(H),hb(H))},"object:selected":function(b){z.deselectElement(!1),H=b.target;var c=H.params;if(H.params.uploadZone&&!d.editorMode)return H.set("borderColor","transparent"),m.find(".fpd-input-image").data("fpd-placeholder",H.title).click(),z.deselectElement(),!1;if(H.set({borderColor:d.selectedColor,cornerColor:"transparent",cornerSize:16,rotatingPointOffset:0,padding:"text"==H.type||"i-text"==H.type?d.paddingControl:0}),j.find(".fpd-elements-dropdown").children('option[value="'+H.id+'"]').prop("selected",!0).parent().trigger("chosen:updated"),Array.isArray(c.colors)&&0!=jb(H)||"path-group"==H.type){if("path-group"==H.type){for(var f=0;f<H.paths.length;++f){var h=H.paths[f],k=tinycolor(h.fill);p.append('<input type="text" value="'+k.toHexString()+'" />')}p.addClass("fpd-colorpicker-group").find("input").spectrum({hexNames:d.hexNames,preferredFormat:"hex",showInput:!0,chooseText:d.labels.colorpicker.change,cancelText:d.labels.colorpicker.cancel,change:function(a){var b=p.find("input").index(this);H.paths[b].setFill(a.toHexString()),e.renderAll();for(var c=[],d=0;d<H.paths.length;++d){var f=H.paths[d],a=tinycolor(f.fill);c.push(a.toHexString())}H.params.currentColor=c}}),"semantic"==d.layout&&(p.removeClass("ui button"),p.children("div").addClass("ui button"))}else p.append('<input type="text" value="'+(c.currentColor?c.currentColor:c.colors[0])+'" />'),c.colors.length>1?p.find("input").spectrum({hexNames:d.hexNames,preferredFormat:"hex",showPaletteOnly:!0,showPalette:!0,palette:c.colors,chooseText:d.labels.colorpicker.change,cancelText:d.labels.colorpicker.cancel,change:function(a){ab(H,a.toHexString())}}):p.find("input").spectrum("destroy").spectrum({hexNames:d.hexNames,preferredFormat:"hex",showInput:!0,chooseText:d.labels.colorpicker.change,cancelText:d.labels.colorpicker.cancel,change:function(a){ab(H,a.toHexString())}});p.css("display","block").parent("div").show()}else p.hide().parent("div").hide();if(("i-text"==H.type||"curvedText"==H.type)&&(q&&(q.children('option[value="'+c.font+'"]').prop("selected",!0).trigger("chosen:updated"),q.parent().show()),n.find(".fpd-text-styles").show().parent("div").show(),c.patternable&&d.patterns.length&&r.show().parent("div").show(),(c.curved||c.curvable)&&(s.show(),s.find(".fpd-curved-text-radius").val(c.curveRadius),s.find(".fpd-curved-text-spacing").val(c.curveSpacing),c.curvable&&(c.curved?(s.find(".fpd-curve-toggle").removeClass("fpd-button-submit green").addClass("fpd-button-danger red").children("i").removeClass("fa-check").addClass("fa-times"),s.find(".fpd-curve-toggle-item").show()):(s.find(".fpd-curve-toggle").removeClass("fpd-button-danger red").addClass("fpd-button-submit green").children("i").removeClass("fa-times").addClass("fa-check"),s.find(".fpd-curve-toggle-item").hide()),s.find(".fpd-curve-toggle").show())),c.editable?n.children(".fpd-text-format-section").find("textarea").val(H.getText()).show():n.children(".fpd-text-format-section").find("textarea").hide()),c.draggable?o.children(".fpd-center-horizontal, .fpd-center-vertical").show():o.children(".fpd-center-horizontal, .fpd-center-vertical").hide(),c.zChangeable?o.children(".fpd-move-down, .fpd-move-up").show():o.children(".fpd-move-down, .fpd-move-up").hide(),c.removable?o.children(".fpd-trash").show():o.children(".fpd-trash").hide(),c.boundingBox&&!d.editorMode){var l=z.getBoundingBoxCoords(H);l&&(B=new fabric.Rect({left:l.left,top:l.top,width:l.width,height:l.height,stroke:d.boundingBoxColor,strokeWidth:1,fill:!1,selectable:!1,evented:!1,originX:"left",originY:"top",name:"bounding-box",params:{x:l.left,y:l.top,scale:1}}),e.add(B),B.bringToFront())}e.renderAll().calcOffset(),n.css("visibility","visible"),i.find('[data-target=".fpd-edit-elements"]').click(),a(window).resize(),_(H),hb(H),g.trigger("elementSelect",[H])}});for(var h=[],t=0;t<u.length;++t){h=a(u.get(t)).children(".fpd-product"),h.splice(0,0,u.get(t));var w=[];h.each(function(b,c){var d=a(c),e={title:c.title,thumbnail:d.data("thumbnail"),elements:[]};d.children("img,span").each(function(b,c){var d,f=a(c);d=f.is("img")?void 0==f.data("src")?f.attr("src"):f.data("src"):f.text();var g={type:f.is("img")?"image":"text",source:d,title:f.is("img")?f.attr("title"):f.text(),parameters:void 0==f.data("parameters")?{}:f.data("parameters")};e.elements.push(g)}),w.push(e)}),z.addProduct(w)}if(v.size()>0){if(v.children(".fpd-category").length>0)A=j.find(".fpd-designs").prepend('<select class="fpd-design-categories" tabindex="1"></select>').children(".fpd-design-categories").change(function(){var b=L[this.value];j.find(".fpd-designs .fpd-items-wrapper > picture").remove();for(var c=0;c<b.length;++c)mb(b[c]);a(this).trigger("chosen:updated")}),v.children(".fpd-category").each(function(b,c){var d=a(c),e=d.data("parameters")?d.data("parameters"):{};d.children("img").each(function(b,d){var f=a(d);z.addDesign(void 0==f.data("src")?f.attr("src"):f.data("src"),f.attr("title"),a.extend({},e,f.data("parameters")),c.title,f.data("thumbnail"))})}),d._useChosen&&A.chosen(),A.change();else for(var C=v.children("img"),t=0;t<C.length;++t){var D=a(C[t]);z.addDesign(void 0==D.data("src")?D.attr("src"):D.data("src"),D.attr("title"),D.data("parameters"),!1,D.data("thumbnail"))}v.remove()}i.find('[data-target=".fpd-edit-elements"]').css("display","inline-block"),d.customTexts&&m.find(".fpd-add-text").click(function(a){a.preventDefault(),z.addElement("text",d.defaultText,d.defaultText,d.customTextParameters,F)}).show();var E=m.find(".fpd-input-image");if(m.find(".fpd-add-image").click(function(a){a.preventDefault(),E.click()}),m.find(".fpd-upload-form").on("change",function(a){if(window.FileReader){var b=new FileReader,c=a.target.files[0].name;b.readAsDataURL(a.target.files[0]),b.onload=function(a){z.addCustomImage(a.target.result,c)}}else alert("FileReader API is not supported in your browser, please use Firefox, Safari, Chrome or IE10!"),E.data("fpd-placeholder","");E.val("")}),d.uploadDesigns&&m.find(".fpd-add-image").show(),d.facebookAppId&&d.facebookAppId.length>0){var I=j.children(".fpd-fb-user-photos"),M=I.find("select").hide(),N=I.find(".fpd-items-wrapper"),O=I.find(".fpd-loading");i.find('[data-target=".fpd-fb-user-photos"]').css("display","inline-block"),d._useChosen&&M.chosen();var P=I.find(".fpd-fb-user-albums").change(function(){O.show();var b=a(this).children("option:selected").val();N.css("visibility","hidden").children("picture").remove(),FB.api("/"+b,function(c){var e=c.count;FB.api("/"+b+"?fields=photos.limit("+e+")",function(b){if(!b.error){for(var c=b.photos.data,e=0;e<c.length;++e){var f=c[e],g=f.images[f.images.length-1]?f.images[f.images.length-1].source:f.source;N.append('<picture><span class="fpd-loading"></span><img src="'+g+'" title="'+f.id+'" data-picture="'+f.source+'" style="display: none;" /></picture>').children("picture:last").click(function(b){b.preventDefault(),y.show();var c=a(this).children("img");a.post(d.phpDirectory+"get_image_data_url.php",{url:c.data("picture")},function(a){if(a&&void 0==a.error){var b=new Image;b.src=a.data_url,b.onload=function(){d.customImagesParameters.scale=z.getScalingByDimesions(this.width,this.height,d.customImagesParameters.resizeToW,d.customImagesParameters.resizeToH),z.addElement("image",this.src,c.attr("title"),d.customImagesParameters,F)}}else alert(a.error);y.hide()},"json").fail(function(a){y.hide(),alert(a.statusText)})}).children("img").load(function(){a(this).fadeIn(500).prev("span").fadeOut(300,function(){a(this).remove(),gb(N)})}).error(function(){a(this).parent().remove()})}N.css("visibility","visible")}O.hide()})})});a.ajaxSetup({cache:!0}),a.getScript("//connect.facebook.com/en_US/sdk.js",function(){FB.init({appId:d.facebookAppId,status:!0,cookie:!0,xfbml:!0,version:"v2.0"}),FB.Event.subscribe("auth.statusChange",function(a){"connected"===a.status?(O.show(),FB.api("/me/albums",function(a){for(var b=a.data,c=0;c<b.length;++c){var d=b[c];P.append('<option value="'+d.id+'">'+d.name+"</option>")}P.next(".chosen-container").size()?P.trigger("chosen:updated").next(".chosen-container").show():P.show(),O.hide()})):(N.css("visibility","hidden").children("picture").remove(),M.children("option:not(:first)").remove(),M.hide().trigger("chosen:updated").next(".chosen-container").hide())})})}if(d.instagramClientId.length&&(i.find('[data-target=".fpd-instagram-photos"]').css("display","inline-block"),j.children(".fpd-instagram-photos").find(".fpd-insta-feed, .fpd-insta-recent-images").click(function(b){b.preventDefault();var c=a(this),d=c.hasClass("fpd-insta-feed")?"feed":"recent";null==window.localStorage.getItem("fpd_instagram_access_token")?pb(function(){qb(d)}):qb(d)})),d.zoomFactor>1?m.find(".fpd-zoom-in, .fpd-zoom-out, .fpd-zoom-reset").click(function(){var b=a(this);b.hasClass("fpd-zoom-in")?z.zoomIn():b.hasClass("fpd-zoom-out")?z.zoomOut():z.zoomReset()}).show():m.find(".fpd-zoom-in, .fpd-zoom-out, .fpd-zoom-reset").hide(),d.allowProductSaving&&g.attr("id")){m.find(".fpd-save-product, .fpd-saved-products").show(),m.find(".fpd-save-product").click(function(a){a.preventDefault(),z.deselectElement();var b=z.getProduct(!1),c=z.getViewsDataURL("png","transparent",.2)[0],d=cb();null==d&&(d=new Array),d.push({thumbnail:c,product:b}),window.localStorage.setItem(g.attr("id"),JSON.stringify(d)),fb(c,b)});var Q=cb();if(null!=Q)for(var t=0;t<Q.length;++t){var R=Q[t];fb(R.thumbnail,R.product)}}if(d.saveAsPdf&&window.jsPDF&&m.find(".fpd-save-pdf").click(function(a){a.preventDefault(),z.deselectElement();for(var b=e.getWidth()>e.getHeight()?"l":"p",c=new jsPDF(b,"mm",[.26*d.dimensions.productStageWidth,.26*d.dimensions.productStageHeight]),f=z.getViewsDataURL("jpeg","white"),g=0;g<f.length;++g)c.addImage(f[g],"JPEG",0,0),g<f.length-1&&c.addPage();c.save("Product.pdf")}).show(),j.find(".fpd-elements-dropdown").change(function(){if("none"==this.value)z.deselectElement();else for(var a=e.getObjects(),b=0;b<a.length;++b)if(a[b].id==this.value){e.setActiveObject(a[b]);break}}),d.fonts.length>0){q=n.find(".fpd-fonts-dropdown").change(function(){H.getWidth(),H.setFontFamily(this.value),H.params.font=this.value,ib(this.value),_(H),e.renderAll(),q.trigger("chosen:updated")}),d.fonts.sort();for(var t=0;t<d.fonts.length;++t){var S=-1==d.fonts[t].indexOf(":")?d.fonts[t]:d.fonts[t].substring(0,d.fonts[t].indexOf(":"));0==q.children('option[value="'+S+'"]').size()&&q.append('<option value="'+S+'" style="font-family: '+S+';">'+S+"</option>")}d._useChosen&&q.chosen({width:"100%"})}if(n.find(".fpd-text-styles").children().click(function(b){b.preventDefault();var c=a(this);c.hasClass("fpd-align-left")?(H.setTextAlign("left"),H.params.textAlign="left"):c.hasClass("fpd-align-center")?(H.setTextAlign("center"),H.params.textAlign="center"):c.hasClass("fpd-align-right")?(H.setTextAlign("right"),H.params.textAlign="right"):c.hasClass("fpd-bold")?nb(H,"fontWeight","bold"==H.getFontWeight()?"":"bold"):c.hasClass("fpd-italic")&&nb(H,"fontStyle","italic"==H.getFontStyle()?"":"italic"),"curvedText"==H.type&&H.setFill(H.fill),e.renderAll()}),s.find(".fpd-curved-text-radius").on("change keyup",function(){H.set("radius",this.value),H.params.curveRadius=this.value,_(H),e.renderAll()}),s.find(".fpd-curved-text-spacing").on("change keyup",function(){H.set("spacing",this.value),H.params.curveSpacing=this.value,_(H),e.renderAll()}),s.find(".fpd-curve-reverse").click(function(){H.set("reverse",!H.reverse),H.params.curveReverse=H.reverse,e.renderAll()}),s.find(".fpd-curve-toggle").click(function(){function a(b,c){e.setActiveObject(c),g.off("elementAdded",a)}var b=ob(H),c=H.getText(),d=H.params;d.z=b,d.curved="i-text"==H.type,g.on("elementAdded",a),z.removeElement(H),z.addElement("text",c,c,d)}),d.patterns&&d.patterns.length>0){for(var t=0;t<d.patterns.length;++t){var T=d.patterns[t];r.children(".fpd-pattern-items").append('<div><img src="'+T+'" class="rounded ui image" /></div>').children("div:last").click(function(){kb(a(this).children("img").attr("src"),H)})}gb(r.children(".fpd-pattern-items"))}o.children(".fpd-center-horizontal, .fpd-center-vertical").click(function(b){b.preventDefault();var c=a(this);eb(H,c.hasClass("fpd-center-horizontal"),c.hasClass("fpd-center-vertical"),B?z.getBoundingBoxCoords(H):!1)}),o.children(".fpd-move-down, .fpd-move-up").click(function(b){b.preventDefault();for(var c,d=e.getObjects(),f=null,g=null,h=0;h<d.length;++h)d[h].viewIndex==F&&(null==f&&(f=h),null==g?g=h:g++),d[h]==H&&(c=h);c>g&&(c=g),f>c&&(c=f),a(this).hasClass("fpd-move-down")?c!=f&&H.moveTo(c-1):c!=g&&H.moveTo(c+1),wb()}),o.children(".fpd-reset").click(function(b){if(b.preventDefault(),H){var c=H.originParams;if(("i-text"==H.type||"curvedText"==H.type)&&(H.fontSize=c.textSize,H.setText(c.source),H.setTextAlign(c.textAlign),H.setFontStyle(c.fontStyle),H.setFontWeight(c.fontWeight),n.children(".fpd-text-format-section").find("textarea").val(c.source),c.font&&(H.setFontFamily(c.font),q&&q.children('option[value="'+c.font+'"]').prop("selected","selected").trigger("chosen:updated"))),c.autoCenter?(db(H),c.x=H.left,c.y=H.top):(H.left=c.x,H.top=c.y),H.scaleX=c.scale,H.scaleY=c.scale,H.angle=c.degree,c.colors&&c.currentColor!=c.colors[0]){var d="path-group"==H.type?c.colors:c.colors[0];ab(H,d)}a(window).resize(),_(H),e.renderAll(),H.params=a.extend({},c)}}),o.children(".fpd-trash").click(function(a){a.preventDefault(),z.removeElement(H)}),n.children(".fpd-text-format-section").find("textarea").keyup(function(){ub(H,this.value)}),d.imageDownloadable&&m.find(".fpd-download-image").click(function(){var a=document.createElement("a");"undefined"!=typeof a.download?m.find(".fpd-download-anchor").attr("href",z.getProductDataURL()).attr("download","Product.png")[0].click():z.createImage(!0,!0)}).show(),d.printable&&m.find(".fpd-print").click(function(a){a.preventDefault(),z.print()}).show(),d.resettable&&m.find(".fpd-reset-product").click(function(a){a.preventDefault(),z.loadProduct(G)}).show(),d._useChosen&&j.find(".fpd-elements-dropdown").chosen({width:"100%"}),d.editorMode&&a.post(d.templatesDirectory+"editorbox.php",function(b){g.after(a.parseHTML(b)),x=g.next(".fpd-editor-box")}),f.remove(),g.fadeIn(500,function(){g.trigger("ready")}),a(window).resize(function(){J=k.outerWidth()<d.dimensions.productStageWidth?k.outerWidth()/d.dimensions.productStageWidth:1,J=Number(J.toFixed(2)),J=J>1?1:J,e.setDimensions({width:k.width()*K,height:d.dimensions.productStageHeight*K*J}),l.height(d.dimensions.productStageHeight*J);for(var a=e.getObjects(),b=0;b<a.length;++b){var c=a[b];c.scaleX=c.params.scale*J*K,c.scaleY=c.params.scale*J*K,c.left=c.params.x*J*K,c.top=c.params.y*J*K,c.setCoords()}e.renderAll().calcOffset()}).resize(),i.find(".fpd-nav-item").click(function(b){b.preventDefault();var c=a(this);c.hasClass("active")||(c.parent().children().removeClass("fpd-secondary-bg-color fpd-primary-text-color active").addClass("fpd-secondary-text-color"),c.removeClass("fpd-secondary-text-color").addClass("fpd-secondary-bg-color fpd-primary-text-color active"),j.children("div").hide(),j.children(c.data("target")).show()),e.calcOffset()}).filter(":visible:first").click(),j.find(".fpd-products .fpd-items-wrapper > picture:first").size()>0?j.find(".fpd-products .fpd-items-wrapper > picture:first").click():y.hide()},Y=function(a){var b=a.params;return("object"==typeof b.colors||b.removable||b.draggable||b.resizable||b.rotatable||b.zChangeable||b.editable||b.patternable||b.uploadZone)&&(a.isEditable=a.evented=!0,a.set("selectable",!0),a.viewIndex!=F||b.uploadZone||j.find(".fpd-elements-dropdown").append('<option value="'+a.id+'">'+a.title+"</option>").trigger("chosen:updated")),d.editorMode?!1:(b.draggable&&!b.uploadZone&&(a.lockMovementX=a.lockMovementY=!1),b.rotatable&&!b.uploadZone&&(a.lockRotation=!1),b.resizable&&!b.uploadZone&&(a.lockScalingX=a.lockScalingY=!1),(b.resizable||b.rotatable||b.removable)&&!b.uploadZone&&(a.hasControls=!0),void 0)},Z=function(b){var c=b.params;if(Y(b),c.replace&&""!=c.replace)for(var d=e.getObjects(),f=0;f<d.length;++f){var g=d[f];if(void 0!=g.params&&void 0==g.clipFor&&g.params.replace==c.replace&&g.type==b.type&&g.visible){c.z=ob(g),c.x=g.params.x,c.y=g.params.y,c.autoCenter=!1,z.removeElement(g);break}}e.add(b),c.autoCenter&&db(b),c.currentColor&&null==c.pattern&&ab(b,c.currentColor),rb(b),c.z>=0&&lb(b,c.z),c.autoSelect&&b.isEditable&&(e.setActiveObject(b),b.setCoords()),wb(),c.topped&&b.bringToFront(),e.renderAll().calcOffset(),a(window).resize()},$=function(a,b){function c(){if(e++,e<b.length){var d=b[e];z.addElement(d.type,d.source,d.title,d.parameters,C-1)}else g.off("elementAdded",c),g.trigger("viewCreate",[b,a])}var d=b[0];if(d){var e=0;g.on("elementAdded",c),z.addElement(d.type,d.source,d.title,d.parameters,C-1)}else g.trigger("viewCreate",[b,a])},_=function(a){if(B&&!a.params.boundingBoxClipping){a.setCoords();var b=a.oCoords.tl,c=!1,f=a.isOut,c=!a.isContainedWithinRect({x:B.oCoords.tl.x,y:B.oCoords.tl.y},{x:B.oCoords.br.x,y:B.oCoords.br.y});c?(a.borderColor=d.outOfBoundaryColor,d.tooltips&&t.css({right:e.getWidth()-b.x-20,top:b.y-t.outerHeight()-10}).show(),a.isOut=!0):(a.borderColor=d.selectedColor,t.hide(),a.isOut=!1),f!=a.isOut&&void 0!=f&&(c?g.trigger("elementOut"):g.trigger("elementIn"))}},ab=function(a,b,c){if(c="undefined"==typeof c?!1:c,4==b.length&&(b+=b.substr(1,b.length)),"i-text"==a.type||"curvedText"==a.type)a.setFill(b),e.renderAll(),0==c&&(a.params.pattern=null),p.find("input").spectrum("set",b);else if("path-group"==a.type)for(var d=0;d<b.length;++d)a.paths[d].setFill(b[d]),p.find("input").eq(d).spectrum("set",b[d]);else{var f=jb(a);if("png"==f||"dataurl"==f){a.filters.push(new fabric.Image.filters.Tint({color:b,opacity:1}));try{a.applyFilters(e.renderAll.bind(e))}catch(g){alert("Image element could not be colorized. Please be sure that the image is hosted under the same domain and protocol, in which you are using the product designer!")}}else"svg"==f&&a.setFill(b);p.find("input").spectrum("set",b)}0==c&&(a.params.currentColor=b),bb(a,b),hb(a)},bb=function(a,b){if(a.colorControlFor)for(var c=a.colorControlFor,d=0;d<c.length;++d)ab(c[d],b)},cb=function(){return JSON.parse(window.localStorage.getItem(g.attr("id")))},db=function(a){eb(a,!0,!0,z.getBoundingBoxCoords(a)),a.params.autoCenter=!1},eb=function(b,c,f,g){var h,i;c&&(h=g?"left"==b.originX?g.left+.5*g.width-.5*b.width:g.left+.5*g.width:"left"==b.originX?.5*d.dimensions.productStageWidth-.5*b.width:.5*d.dimensions.productStageWidth,b.left=h),f&&(i=g?"left"==b.originX?g.top+.5*g.height-.5*b.width:g.top+.5*g.height:"left"==b.originX?.5*d.dimensions.productStageHeight-.5*b.height:.5*d.dimensions.productStageHeight,b.top=i),_(b),e.renderAll(),b.setCoords(),void 0!=h&&(b.params.x=h),void 0!=i&&(b.params.y=i),a(window).resize()},fb=function(b,c){var e=m.find(".fpd-saved-products");e.find(".menu").append('<div class="item fpd-clearfix"><img src="'+b+'" /><i class="fpd-primary-text-color fa fa-times"></i></div>').children("div:last").click(function(){z.loadProduct(a(this).data("product")),D=-1}).data("product",c).children("i").click(function(b){b.stopPropagation();var c=confirm(d.labels.confirmProductDelete);if(!c)return!1;var f=e.find(".menu > .item"),h=f.index(a(this).parent(".item").remove()),i=cb();i.splice(h,1),window.localStorage.setItem(g.attr("id"),JSON.stringify(i))}),e.hover(function(){e.find(".menu").slideDown()},function(){e.find(".menu").stop().slideUp()})},gb=function(b){b.hasClass("ps-container")?b.perfectScrollbar("update").scrollTop(0):b.perfectScrollbar({includePadding:!0}).mouseenter(function(){a(this).perfectScrollbar("update")})},hb=function(a){if(void 0==x)return!1;var b=a.params;x.find(".fpd-current-element").text(a.title),x.find(".fpd-position").text("x: "+b.x+" y: "+b.y),x.find(".fpd-dimensions").text("width: "+Math.round(a.getWidth())+" height: "+Math.round(a.getHeight())),x.find(".fpd-scale").text(Number(b.scale)%360),x.find(".fpd-degree").text(b.degree),x.find(".fpd-color").text(b.currentColor)},ib=function(a){WebFont.load({custom:{families:[a]},fontactive:function(){e.renderAll()}})},jb=function(b){if("i-text"==b.type||"curvedText"==b.type)return"text";var c=b.source.split(".");return 1==c.length?-1==c[0].search("data:image/png;")?(b.params.currentColor=b.params.colors=!1,!1):"dataurl":-1==a.inArray("png",c)&&-1==a.inArray("svg",c)?(b.params.currentColor=b.params.colors=!1,!1):-1==a.inArray("svg",c)?"png":"svg"
},kb=function(a,b){"image"==b.type||("i-text"==b.type||"curvedText"==b.type)&&fabric.util.loadImage(a,function(c){b.setFill(new fabric.Pattern({source:c,repeat:"repeat"})),e.renderAll(),b.params.pattern=a})},lb=function(a,b){for(var c=e.getObjects(),d=0,f=0;f<c.length;++f){var g=c[f];if(g.visible){if(d==b){a.moveTo(f);break}d++}}},mb=function(b){var c=j.find(".fpd-designs .fpd-items-wrapper");c.append('<picture data-source="'+b.source+'"><span class="fpd-loading"></span><img src="'+b.thumbnail+'" title="'+b.title+'" style="display: none;" /></picture>').children("picture:last").click(function(b){b.preventDefault();var c=a(this),d=c.data("parameters");z.addElement("image",c.data("source"),c.children("img").attr("title"),d,F)}).data("parameters",b.parameters).children("img").load(function(){a(this).fadeIn(500).prev("span").fadeOut(300,function(){a(this).remove(),gb(c)})})},nb=function(a,b,c){a[b]=a.params[b]=c},ob=function(a){for(var b=e.getObjects(),c=0,d=0;d<b.length;++d)if(b[d].visible){if(a===b[d])return c;c++}},pb=function(a){var b=(window.screen.width-700)/2,c=(window.screen.height-500)/2,e=window.open(d.phpDirectory+"/instagram_auth.php","","width=700,height=500,left="+b+",top="+c);xb(e),e.onload=new function(){0==window.location.hash.length&&e.open("https://instagram.com/oauth/authorize/?client_id="+d.instagramClientId+"&redirect_uri="+d.instagramRedirectUri+"&response_type=token","_self");var b=setInterval(function(){try{e.location.hash.length&&(clearInterval(b),window.localStorage.setItem("fpd_instagram_access_token",e.location.hash.slice(14)),e.close(),void 0!=a&&"function"==typeof a&&a())}catch(c){}},100)}},qb=function(b){var c,e=window.localStorage.getItem("fpd_instagram_access_token");switch(b){case"feed":c="https://api.instagram.com/v1/users/self/feed?access_token="+e;break;case"recent":c="https://api.instagram.com/v1/users/self/media/recent?access_token="+e;break;default:c=b}var f=j.children(".fpd-instagram-photos").children(".fpd-items-wrapper").css("visibility","hidden"),g=j.children(".fpd-instagram-photos").find(".fpd-insta-load-next");f.children("picture").remove(),a.ajax({method:"GET",url:c,dataType:"jsonp",jsonp:"callback",jsonpCallback:"jsonpcallback",cache:!1,success:function(c){c.data?(c.pagination&&c.pagination.next_url?g.removeClass("disabled").data("href",c.pagination.next_url).off("click").on("click",function(){qb(a(this).data("href")),g.addClass("disabled").off("click")}):g.addClass("disabled").off("click"),a.each(c.data,function(b,c){"image"==c.type&&f.append('<picture><span class="fpd-loading"></span><img src="'+c.images.thumbnail.url+'" title="'+c.id+'" data-picture="'+c.images.standard_resolution.url+'" style="display: none;" /></picture>').children("picture:last").click(function(b){b.preventDefault(),y.show();var c=a(this).children("img");a.post(d.phpDirectory+"get_image_data_url.php",{url:c.data("picture")},function(a){if(a&&void 0==a.error){var b=new Image;b.src=a.data_url,b.onload=function(){d.customImagesParameters.scale=z.getScalingByDimesions(this.width,this.height,d.customImagesParameters.resizeToW,d.customImagesParameters.resizeToH),z.addElement("image",this.src,c.attr("title"),d.customImagesParameters,F)}}else alert(a.error);y.hide()},"json").fail(function(a){y.hide(),alert(a.statusText)})}).children("img").load(function(){a(this).fadeIn(500).prev("span").fadeOut(300,function(){a(this).remove(),gb(f)})}).error(function(){a(this).parent().remove()})}),f.css("visibility","visible")):pb(function(){qb(b)})},error:function(){alert("Could not load data from instagram. Please try again!")}})},rb=function(a){var b=a.params;if(b.boundingBox&&b.boundingBoxClipping){var c=z.getBoundingBoxCoords(a);if(c){var d=new fabric.Rect({left:c.left,top:c.top,width:c.width,height:c.height,originX:"left",originY:"top",fill:"transparent",selectable:!1,evented:!1,clipFor:a.id,viewIndex:a.viewIndex,visible:!1,params:{x:c.left,y:c.top,scale:b.scale}});e.add(d),a.setClipTo(function(a){tb(a,this)})}}},sb=function(a){for(var b=e.getObjects(),c=0;c<b.length;++c)if(b[c].clipFor==a)return b[c]},tb=function(a,b){var c=sb(b.id),d=1/b.scaleX,e=1/b.scaleY;a.save(),a.translate(0,0),a.rotate(fabric.util.degreesToRadians(-1*b.angle)),a.scale(d,e),a.beginPath(),a.rect(c.left-b.left-("left"==b.originX?.5*b.width:0),c.top-b.top-("top"==b.originY?.5*b.height:0),c.width*K*J,c.height*K*J),a.fillStyle="transparent",a.fill(),a.closePath(),a.restore()},ub=function(a,b){0!=a.params.maxLength&&b.length>a.params.maxLength&&(b=b.substr(0,a.params.maxLength),a.selectionStart=a.params.maxLength),j.find(".fpd-elements-dropdown").children('option[value="'+a.id+'"]').text(b).trigger("chosen:updated"),n.children(".fpd-text-format-section").find("textarea").val(b),a.params.text=a.title=b,a.setText(b),e.renderAll(),_(a)},vb=function(a){for(var b=e.getObjects(),c=0;c<b.length;++c){var d=b[c];d.scaleX=d.params.scale*a*K,d.scaleY=d.params.scale*a*K,d.left=d.params.x*a*K,d.top=d.params.y*a*K,d.setCoords()}return b},wb=function(){for(var a=e.getObjects(),b=[],c=0;c<a.length;++c){var d=a[c];d.visible&&d.params.topped&&b.push(d)}for(var c=0;c<b.length;++c)b[c].bringToFront()},xb=function(a){(null==a||"undefined"==typeof a)&&alert("Please disable your pop-up blocker and try again.")};this.getBoundingBoxCoords=function(a){var b=a.params;if(b.boundingBox||b.uploadZone){if("object"==typeof b.boundingBox)return{left:b.boundingBox.x,top:b.boundingBox.y,width:b.boundingBox.width,height:b.boundingBox.height};for(var c=e.getObjects(),d=0;d<c.length;++d){var f=c[d];if(f.viewIndex==F&&b.boundingBox==f.title){var g=f.getBoundingRect();return{left:g.left/J/K,top:g.top/J/K,width:g.width/J/K,height:g.height/J/K}}}}return!1},this.getFabricJSON=function(){z.deselectElement();var a=e.toJSON(["viewIndex"]);return a.width=e.width,a.height=e.height,a},this.getPrice=function(){return I},this.getProduct=function(a){a="undefined"!=typeof a?a:!1,z.deselectElement(),z.zoomReset();for(var b=e.getObjects(),c=0;c<b.length;++c){var f=b[c];if(f.isOut)return alert('"'+f.title+'":'+d.labels.outOfContainmentAlert),!1}for(var g=[],c=0;c<G.length;++c){var h=G[c];g.push({title:h.title,thumbnail:h.thumbnail,elements:[]})}for(var c=0;c<b.length;++c){var f=b[c],i={title:f.title,source:f.source,parameters:f.params,type:"i-text"==f.type||"curvedText"==f.type?"text":"image"};void 0==f.clipFor&&(a?f.isEditable&&g[f.viewIndex].elements.push(i):g[f.viewIndex].elements.push(i))}return g},this.getProductIndex=function(){return D},this.getResponsiveScale=function(){return J},this.getViewsDataURL=function(a,b,c){a="undefined"!=typeof a?a:"png",b="undefined"!=typeof b?b:"transparent",c="undefined"!=typeof c?c:1,z.deselectElement(),z.zoomReset();var f=[],g=e.getWidth(),h=e.getHeight();return e.setDimensions({width:d.dimensions.productStageWidth,height:d.dimensions.productStageHeight}).setBackgroundColor(b,function(){for(var b=vb(1),d=0;C>d;++d){for(var i=0;i<b.length;++i){var j=b[i];j.visible=j.viewIndex==d}try{f.push(e.toDataURL({format:a,multiplier:c}))}catch(k){alert("Error: Please be sure that the images are hosted under the same domain and protocol, in which you are using the product designer!")}}for(var d=0;d<b.length;++d){var j=b[d];j.visible=j.viewIndex==F}vb(J),e.setDimensions({width:g,height:h}).setBackgroundColor("transparent").renderAll()}),f},this.getViewsSVG=function(){z.deselectElement(),z.zoomReset();var b=[],c=e.getWidth(),f=e.getHeight();e.setDimensions({width:d.dimensions.productStageWidth,height:d.dimensions.productStageHeight});for(var g=vb(1),h=0;C>h;++h){for(var i=0;i<g.length;++i){var j=g[i];j.visible=j.viewIndex==h,"path-group"==j.type&&(j.left=1*j.params.x-.5*j.getWidth(),j.top=1*j.params.y-.5*j.getHeight(),j.setCoords())}var k=e.toSVG(),l=a(k);l.children("rect").remove(),l.children("g").children('[style*="visibility: hidden"]').parent("g").remove(),k=a("<div>").append(l.clone()).html().replace(/(?:\r\n|\r|\n)/g,""),b.push(k)}for(var h=0;h<g.length;++h){var j=g[h];j.visible=j.viewIndex==F,"path-group"==j.type&&(j.left=j.params.x*J,j.top=j.params.y*J,j.setCoords())}return vb(J),e.setDimensions({width:c,height:f}).renderAll(),b},this.getProductDataURL=function(a,b,c){a="undefined"!=typeof a?a:"png",b="undefined"!=typeof b?b:"transparent",c="undefined"!=typeof c?c:1,z.deselectElement(),z.zoomReset(),z.selectView(0);var f,g=e.getWidth(),h=e.getHeight();return e.setBackgroundColor(b,function(){e.setDimensions({width:d.dimensions.productStageWidth,height:d.dimensions.productStageHeight*C});for(var b=vb(1),i=0;i<b.length;++i){var j=b[i];j.visible=!0,j.top=j.top+j.viewIndex*d.dimensions.productStageHeight}try{f=e.toDataURL({format:a,multiplier:c})}catch(k){alert("Error: Please be sure that the images are hosted under the same domain and protocol, in which you are using the product designer!")}for(var i=0;i<b.length;++i){var j=b[i];j.visible=0==j.viewIndex,j.top=j.top-j.viewIndex*d.dimensions.productStageHeight}vb(J),e.setDimensions({width:g,height:h}).setBackgroundColor("transparent").renderAll()}),f},this.getProductsLength=function(){return j.find(".fpd-products .fpd-items-wrapper > picture").size()},this.getView=function(){return G[F]},this.getViewDataURL=function(a,b,c){a="undefined"!=typeof a?a:"png",b="undefined"!=typeof b?b:"transparent",c="undefined"!=typeof c?c:1,z.deselectElement(),z.zoomReset();var f="",g=e.getWidth(),h=e.getHeight();return e.setDimensions({width:d.dimensions.productStageWidth,height:d.dimensions.productStageHeight}).setBackgroundColor(b,function(){vb(1);try{f=e.toDataURL({format:a,multiplier:c})}catch(b){return alert("Error: Please be sure that the images are hosted under the same domain and protocol, in which you are using the product designer!"),!1}vb(J),e.setDimensions({width:g,height:h}).setBackgroundColor("transparent").renderAll()}),f.length?f:!1},this.getViewSVG=function(){z.deselectElement(),z.zoomReset();var b=e.getWidth(),c=e.getHeight();e.setDimensions({width:d.dimensions.productStageWidth,height:d.dimensions.productStageHeight}),vb(1);for(var f=0;f<e.getObjects().length;++f){var g=e.getObjects()[f];"path-group"==g.type&&(g.left=1*g.params.x-.5*g.getWidth(),g.top=1*g.params.y-.5*g.getHeight(),g.setCoords())}var h=e.toSVG(),i=a(h);i.children("rect").remove(),i.children("g").children('[style*="visibility: hidden"]').parent("g").remove(),h=a("<div>").append(i.clone()).html().replace(/(?:\r\n|\r|\n)/g,"");for(var f=0;f<e.getObjects().length;++f){var g=e.getObjects()[f];"path-group"==g.type&&(g.left=g.params.x*J,g.top=g.params.y*J,g.setCoords())}return vb(J),e.setDimensions({width:b,height:c}).renderAll(),h},this.getViewIndex=function(){return F},this.getStage=function(){return e},this.getScalingByDimesions=function(a,b,c,d){var e=1;return a>b?(a>c&&(e=c/a),e*b>d&&(e=d/b)):(b>d&&(e=d/b),e*a>c&&(e=c/a)),e},this.addProduct=function(b){var c=j.find(".fpd-products .fpd-items-wrapper");c.append('<picture ><span class="fpd-loading"></span><img src="'+b[0].thumbnail+'" title="'+b[0].title+'" style="display:none;" /></picture>').children("picture:last").click(function(b){var d=a(this),e=c.children("picture").index(d);z.selectProduct(e),b.preventDefault()}).data("views",b).children("img").load(function(){a(this).fadeIn(500).prev("span").fadeOut(300,function(){a(this).remove()})}),2==c.children("picture").length&&(i.find('[data-target=".fpd-products"]').css("display","inline-block"),gb(c)),c.perfectScrollbar("update")},this.loadProduct=function(a){function b(){if(C<G.length)z.addView(G[C]);else{g.off("viewCreate",b),g.trigger("productCreate",[E]),y.stop().hide(),z.selectView(0);for(var a=e.getObjects(),c=0;c<a.length;++c){var d=a[c];d.viewIndex==F&&d.params&&d.params.autoSelect&&(e.setActiveObject(d),d.setCoords())}}}if(y.is(":visible"))return!1;z.clear(),y.stop().show(),G=a,E=G[0].title;var c='<div class="fpd-views-selection fpd-clearfix fpd-'+d.viewSelectionPosition+" "+(d.viewSelectionFloated?"fpd-float-items":"")+'"></div>';"outside"==d.viewSelectionPosition?l.after(c):l.append(c),g.on("viewCreate",b),z.addView(G[0])},this.selectProduct=function(a){if(a==D)return!1;D=a,0>a?D=0:a>z.getProductsLength()-1&&(D=z.getProductsLength()-1);var b=j.find(".fpd-products .fpd-items-wrapper > picture").eq(D).data("views");z.loadProduct(b)},this.selectView=function(a){F=a,0>a?F=0:a>w.children().size()-1&&(F=w.children().size()-1),w.children("div").removeClass("fpd-view-active").eq(a).addClass("fpd-view-active"),z.deselectElement(),j.find(".fpd-elements-dropdown").children('option:not([value="none"])').remove();for(var b=e.getObjects(),c=0;c<b.length;++c){var d=b[c];d.visible=d.viewIndex==F,d.viewIndex==F&&d.isEditable&&!d.params.uploadZone&&j.find(".fpd-elements-dropdown").append('<option value="'+d.id+'">'+d.title+"</option>")}j.find(".fpd-elements-dropdown").trigger("chosen:updated"),e.renderAll()},this.removeProduct=function(a){0>a?a=0:a>z.getProductsLength()-1&&(a=z.getProductsLength()-1),j.find(".fpd-products .fpd-items-wrapper > picture").eq(a).remove(),j.find(".fpd-products .fpd-items-wrapper").perfectScrollbar("update"),a==D&&(z.clear(),D=-1)},this.addView=function(b){C++,w=k.find(".fpd-views-selection");var c="outside"==d.viewSelectionPosition?"stacked":"";w.append('<div class="fpd-secondary-bg-color fpd-border-color ui '+c+' segment"><img src="'+b.thumbnail+'" title="'+b.title+'" class="fpd-tooltip" /></div>').children("div:last").click(function(b){b.preventDefault(),z.selectView(w.children("div").index(a(this)))}),$(b.title,b.elements),C>1?w.show():w.hide()},this.addElement=function(b,c,f,h,i){if(i="undefined"!=typeof i?i:F,z.deselectElement(),"object"!=typeof h)return alert("The element "+f+" does not have a valid JSON object as parameters! Please check the syntax, maybe you set quotes wrong."),!1;h=a.extend({},d.elementParameters,h),("text"==b||"i-text"==b||"curvedText"==b)&&(h=a.extend({},d.textParameters,h)),h.topped&&(h.zChangeable=!1),h.source=c;var j=!1,k=null;if(h.colors&&"string"==typeof h.colors)if(0==h.colors.indexOf("#")){var l=h.colors.replace(/\s+/g,"").split(",");h.colors=l}else if(C>1)for(var m=e.getObjects(),n=0;n<m.length;++n){var o=m[n];0==o.viewIndex&&h.colors==o.title&&null==k&&(k=o,j=!0)}var p={source:c,title:f,top:h.y,left:h.x,originX:h.originX,originY:h.originY,scaleX:h.scale,scaleY:h.scale,angle:h.degree,opacity:h.opacity,id:String((new Date).getTime()),visible:i==F,viewIndex:i,lockUniScaling:!0,lineHeight:1.2};if(d.editorMode?h.removable=h.resizable=h.rotatable=h.zChangeable=!0:a.extend(p,{selectable:!1,lockRotation:!0,lockScalingX:!0,lockScalingY:!0,lockMovementX:!0,lockMovementY:!0,hasControls:!1,evented:!1}),"image"==b||"path"==b){var q=function(b,c){b.width*c.scale,b.height*c.scale,a.extend(p,{params:c,originParams:a.extend({},c),crossOrigin:"anonymous"}),b.set(p),j&&(k.colorControlFor?k.colorControlFor.push(b):(k.colorControlFor=[],k.colorControlFor.push(b))),Z(b),g.trigger("elementAdded",[b])},r=c.split(".");-1!=a.inArray("svg",r)?fabric.loadSVGFromURL(c,function(a,b){var c=fabric.util.groupSVGElements(a,b);h.colors=[];for(var d=0;d<a.length;++d){var e=tinycolor(a[d].fill);h.colors.push(e.toHexString())}q(c,h)}):new fabric.Image.fromURL(c,function(a){q(a,h)})}else{if("text"!=b&&"i-text"!=b&&"curvedText"!=b)return alert("Sorry. This type of element is not allowed!"),!1;if(h.text=h.text?h.text:h.source,h.font=h.font?h.font:d.fonts[0],void 0==h.font&&(h.font="Arial"),a.extend(p,{fontSize:h.textSize,fontFamily:h.font,fontStyle:h.fontStyle,fontWeight:h.fontWeight,textAlign:h.textAlign,textBackgroundColor:h.textBackgroundColor,lineHeight:h.lineHeight,textDecoration:h.textDecoration,fill:h.colors[0]?h.colors[0]:"#000000",editable:h.editable,spacing:h.curveSpacing,radius:h.curveRadius,reverse:h.curveReverse,params:h,originParams:a.extend({},h)}),h.curved)var s=new fabric.CurvedText(h.text.replace(/\\n/g,"\n"),p);else var s=new fabric.IText(h.text.replace(/\\n/g,"\n"),p);Z(s),h.pattern&&kb(h.pattern,s),ib(h.font),g.trigger("elementAdded",[s])}h.price&&!h.uploadZone&&(I+=h.price,g.trigger("priceChange",[h.price,I]))},this.addDesign=function(a,b,c,d,e){e="undefined"==typeof e?a:e,null===A||A===!1?mb({source:a,title:b,parameters:c,thumbnail:e}):(d="undefined"==typeof d?A.val():d,void 0==L[d]&&(L[d]=new Array,A.append('<option value="'+d+'">'+d+"</option>").trigger("chosen:updated")),L[d].push({source:a,title:b,parameters:c,thumbnail:e}),A.val()==d&&mb({source:a,title:b,parameters:c,thumbnail:e})),i.find('[data-target=".fpd-designs"]').css("display","inline-block")},this.addCustomImage=function(b,c){z.zoomReset();var e=m.find(".fpd-input-image"),f=new Image;f.src=b,f.onload=function(){var f=this.height,g=this.width;if(g>d.customImagesParameters.maxW||g<d.customImagesParameters.minW||f>d.customImagesParameters.maxH||f<d.customImagesParameters.minH)return alert(d.labels.uploadedDesignSizeAlert),!1;d.customImagesParameters.scale=z.getScalingByDimesions(g,f,d.customImagesParameters.resizeToW,d.customImagesParameters.resizeToH);var h=d.customImagesParameters;if(e.data("fpd-placeholder")&&""!=e.data("fpd-placeholder")){var i=z.getElementByTitle(e.data("fpd-placeholder")),j=i.getBoundingRect();h=a.extend({},h,{boundingBox:e.data("fpd-placeholder"),boundingBoxClipping:i.params.boundingBoxClipping,scale:z.getScalingByDimesions(g,f,j.width/J-1,j.height/J-1),autoCenter:!0,removable:!0,zChangeable:!1,rotatable:i.params.rotatable,draggable:i.params.draggable,resizable:i.params.resizable,price:i.params.price,replace:e.data("fpd-placeholder")})}z.addElement("image",b,c,h),z.addDesign(b,c,h,d.labels.myUploadedImgCat),e.data("fpd-placeholder","")},f.onerror=function(){alert("Image could not be loaded!"),e.data("fpd-placeholder","")}},this.print=function(){for(var b=z.getViewsDataURL(),c=new Array,d=0,e=0;e<b.length;++e){var f=new Image;f.src=b[e],f.onload=function(){if(c.push(this),d++,d==b.length){var e=window.open("","","width="+c[0].width+",height="+c[0].height*b.length+",location=no,menubar=no,scrollbars=yes,status=no,toolbar=no");xb(e),e.document.title="Print Image";for(var f=0;f<c.length;++f)a(e.document.body).append('<img src="'+c[f].src+'" />');setTimeout(function(){e.print()},1e3)}}}return!1},this.createImage=function(b,c){"undefined"==typeof b&&(b=!0),"undefined"==typeof c&&(c=!1);var d=z.getProductDataURL(),e=new Image;return e.src=d,e.onload=function(){if(b){var e=window.open("","","width="+this.width+",height="+this.height+",location=no,menubar=no,scrollbars=yes,status=no,toolbar=no");xb(e),e.document.title="Product Image",a(e.document.body).append('<img src="'+this.src+'" />'),c&&(window.location.href=e.document.getElementsByTagName("img")[0].src.replace("image/png","image/octet-stream"))}g.trigger("imageCreate",[d])},e},this.clear=function(){z.deselectElement(),z.zoomReset(),w&&w.remove(),j.find(".fpd-elements-dropdown").children('option:not([value="none"])').remove(),j.find(".fpd-elements-dropdown").trigger("chosen:updated"),e.clear(),C=F=I=0,G=H=null,g.trigger("stageClear")},this.deselectElement=function(a){a="undefined"==typeof a?!0:a,p.removeClass("fpd-colorpicker-group").empty(),"semantic"==d.layout&&p.addClass("ui button"),t.hide(),B&&(B.remove(),B=null),a&&e.discardActiveObject(),j.find(".fpd-elements-dropdown").children("option:first").prop("selected",!0).trigger("chosen:updated"),n.css("visibility","hidden").children(".fpd-filling-wrapper, .fpd-text-format-section, .fpd-curved-text-wrapper").hide().parent().find(".fpd-color-picker, .fpd-fonts-dropdown-wrapper, .fpd-text-styles").hide(),n.children(".fpd-text-format-section").find("textarea").val(""),r.hide(),s.hide().find(".fpd-curve-toggle").hide(),H=null,x&&x.find("i").text(""),e.renderAll().calcOffset()},this.removeElement=function(a){"string"==typeof a&&(a=z.getElementByTitle(a)),0==a.params.price||a.params.uploadZone||(I-=a.params.price,g.trigger("priceChange",[a.params.price,I])),j.find(".fpd-elements-dropdown").children('option[value="'+a.id+'"]').remove().trigger("chosen:updated"),e.remove(a),g.trigger("elementRemove",[a]),z.deselectElement()},this.getElementByTitle=function(a){for(var b=e.getObjects(),c=0;c<b.length;++c)if(b[c].title==a)return b[c]},this.zoomIn=function(){if(K*=d.zoomFactor,K>d.zoomRange[1])return!1;for(var a=e.getObjects(),b=0;b<a.length;++b){var c=a[b];c.scaleX=c.scaleX*d.zoomFactor,c.scaleY=c.scaleY*d.zoomFactor,c.left=c.left*d.zoomFactor,c.top=c.top*d.zoomFactor,c.setCoords()}e.setDimensions({width:e.getWidth()*d.zoomFactor,height:e.getHeight()*d.zoomFactor}).calcOffset().renderAll(),K>1&&l.perfectScrollbar()},this.zoomOut=function(){if(K/=d.zoomFactor,K<d.zoomRange[0])return!1;for(var a=e.getObjects(),b=0;b<a.length;++b){var c=a[b];c.scaleX=c.scaleX*(1/d.zoomFactor),c.scaleY=c.scaleY*(1/d.zoomFactor),c.left=c.left*(1/d.zoomFactor),c.top=c.top*(1/d.zoomFactor),c.setCoords()}e.setDimensions({width:e.getWidth()*(1/d.zoomFactor),height:e.getHeight()*(1/d.zoomFactor)}).calcOffset().renderAll(),1>=K&&l.perfectScrollbar("destroy")},this.zoomReset=function(){K=1;for(var a=e.getObjects(),b=0;b<a.length;++b){var c=a[b];c.scaleX=a[b].params.scale*J,c.scaleY=a[b].params.scale*J,c.left=a[b].params.x*J,c.top=a[b].params.y*J,c.setCoords()}e.setDimensions({width:k.width(),height:d.dimensions.productStageHeight*J}).calcOffset().renderAll(),1>=K&&l.perfectScrollbar("destroy")},this.setStageDimensions=function(a,b){d.dimensions.productStageWidth=a,d.dimensions.productStageHeight=b,k.width(a),l.height(b*J),e.setDimensions({width:k.width(),height:d.dimensions.productStageHeight*J}).calcOffset().renderAll()},fabric.Object.prototype._drawControl=function(a,b,c,d,e){var f=this.cornerSize;if(this.isControlVisible(a)&&(this.transparentCorners||b.clearRect(d,e,f,f),"tr"==a||"br"==a||"mtr"==a)){var g;switch(a){case"tr":g=this.params.removable?O:!1;break;case"br":g=this.params.resizable?N:!1;break;case"mtr":g=this.params.rotatable?M:!1}g!==!1&&(b.drawImage(g,d,e,f,f),b[c](d,e,f,f))}},fabric.Object.prototype.findTargetCorner=function(a){if(!this.hasControls||!this.active)return!1;var b,c,d=a.x,e=a.y;for(var f in this.oCoords)if(this.isControlVisible(f)&&("mtr"!==f||this.hasRotatingPoint)&&(!this.get("lockUniScaling")||"mt"!==f&&"mr"!==f&&"mb"!==f&&"ml"!==f)&&(c=this._getImageLines(this.oCoords[f].corner),b=this._findCrossPoints({x:d,y:e},c),0!==b&&1===b%2))return this.__corner=f,f;return!1},fabric.IText.prototype.initHiddenTextarea=function(){this.hiddenTextarea=fabric.document.createElement("textarea"),this.hiddenTextarea.setAttribute("autocapitalize","off"),this.hiddenTextarea.style.cssText="position: absolute; top: 0; left: -100px; opacity: 0; width: 0; height: 0; z-index: -99999;",this.canvas.wrapperEl.appendChild(this.hiddenTextarea),fabric.util.addListener(this.hiddenTextarea,"keydown",this.onKeyDown.bind(this)),fabric.util.addListener(this.hiddenTextarea,"keypress",this.onKeyPress.bind(this)),fabric.util.addListener(this.hiddenTextarea,"copy",this.copy.bind(this)),fabric.util.addListener(this.hiddenTextarea,"paste",this.paste.bind(this)),!this._clickHandlerInitialized&&this.canvas&&(fabric.util.addListener(this.canvas.upperCanvasEl,"click",this.onClick.bind(this)),this._clickHandlerInitialized=!0)}};jQuery.fn.fancyProductDesigner=function(c){return this.each(function(){var d=a(this);if(!d.data("fancy-product-designer")){var e=new b(this,c);d.data("fancy-product-designer",e)}})},a.fn.fancyProductDesigner.defaults={_useChosen:!0,elementParameters:{x:0,y:0,z:-1,colors:!1,removable:!1,draggable:!1,rotatable:!1,resizable:!1,zChangeable:!1,scale:1,degree:0,price:0,boundingBox:!1,autoCenter:!1,opacity:1,originX:"center",originY:"center",replace:"",boundingBoxClipping:!1,autoSelect:!1,topped:!1,uploadZone:!1},textParameters:{font:!1,fontWeight:"",fontStyle:"",textSize:18,patternable:!1,editable:!0,lineHeight:1,textAlign:"left",textBackgroundColor:"",textDecoration:"",maxLength:0,curved:!1,curvable:!1,curveSpacing:10,curveRadius:80,curveReverse:!1},customImagesParameters:{minW:100,minH:100,maxW:1500,maxH:1500,resizeToW:300,resizeToH:300},customTextParameters:{},uploadDesigns:!0,customTexts:!0,imageDownloadable:!0,saveAsPdf:!0,printable:!0,allowProductSaving:!0,resettable:!0,tooltips:!0,editorMode:!1,menubarPosition:"outside",viewSelectionPosition:"tr",viewSelectionFloated:!1,fonts:["Arial","Helvetica","Times New Roman","Verdana","Geneva"],templatesDirectory:"templates/",phpDirectory:"php/",patterns:[],layout:"icon-sb-left",facebookAppId:"",instagramClientId:"",instagramRedirectUri:"",zoomFactor:1.2,zoomRange:[.2,2],defaultText:"Double-click to change text",hexNames:{},selectedColor:"#d5d5d5",boundingBoxColor:"#005ede",outOfBoundaryColor:"#990000",paddingControl:7,dimensions:{sidebarNavSize:50,sidebarContentWidth:200,sidebarSize:700,productStageWidth:600,productStageHeight:600},labels:{outOfContainmentAlert:"Move it in his containment!",confirmProductDelete:"Delete saved product?",colorpicker:{cancel:"Cancel",change:"Change Color"},uploadedDesignSizeAlert:"Sorry! But the uploaded image size does not conform our indication of size.",initText:"Initializing product designer",myUploadedImgCat:"Your uploaded images"},sidebarLabels:{productsMenu:"Products",designsMenu:"Designs",editElementsMenu:"Edit Elements",fbPhotosMenu:"Add Photos From Facebook",instaPhotosMenu:"Add Photos From Instagram",editElementsHeadline:"Edit Elements",editElementsDropdownNone:"None",sectionFilling:"Filling",sectionFontsStyles:"Font & Style",sectionCurvedText:"Curved Text",sectionHelpers:"Helpers",textAlignLeft:"Align Left",textAlignCenter:"Align Center",textAlignRight:"Align Right",textBold:"Bold",textItalic:"Italic",curvedTextInfo:"You can only change the text when you switch to normal text.",curvedTextSpacing:"Spacing",curvedTextRadius:"Radius",curvedTextReverse:"Reverse",curvedTextToggle:"Switch between curved and normal Text",centerH:"Center Horizontal",centerV:"Center Vertical",moveDown:"Bring It Down",moveUp:"Bring It Up",reset:"Reset",trash:"Trash",fbPhotosHeadline:"Facebook Photos",fbSelectAlbum:"Select an album",instaPhotosHeadline:"Instagram Photos",instaFeedButton:"My Feed",instaRecentImagesButton:"My Recent Images",instaLoadNext:"Load next stack"},productStageLabels:{addImageTooltip:"Add your own Image",addTextTooltip:"Add your own Text",zoomInTooltip:"Zoom In",zoomOutTooltip:"Zoom Out",zoomResetTooltip:"Zoom Reset",downloadImageTooltip:"Download Product Image",printTooltip:"Print",pdfTooltip:"Save As PDF",saveProductTooltip:"Save product",savedProductsTooltip:"Your saved products",resetTooltip:"Reset Product"}}}(jQuery);